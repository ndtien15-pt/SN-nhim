<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gửi Nhím ❤️</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --pink: #ff4d6d; --bg: #fff0f3; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--bg); font-family: 'Quicksand', sans-serif;
            overflow: hidden; 
        }

        /* Container tổng để căn giữa mọi thứ */
        .wrapper {
            display: flex; justify-content: center; align-items: center;
            width: 100%; height: 100%; position: relative;
        }

        /* Intro */
        #intro {
            position: fixed; inset: 0; background: #ffc2d1;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 1000; transition: opacity 0.8s; color: white; text-align: center;
        }
        #start-btn {
            margin-top: 20px; padding: 15px 40px; border-radius: 50px; border: none;
            background: white; color: var(--pink); font-weight: bold; cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); font-size: 1.1rem;
        }

        /* Gallery - Khóa vào giữa */
        #main-app { display: none; width: 100%; height: 100%; }
        
        .gallery-content {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            width: 100%; height: 100%; position: relative;
        }

        .polaroid {
            background: white; padding: 10px 10px 50px 10px; border-radius: 5px;
            box-shadow: 0 15px 45px rgba(255, 77, 109, 0.25);
            width: 85%; max-width: 320px; transition: 0.3s ease;
            position: relative; z-index: 10;
        }
        .polaroid img { width: 100%; height: 380px; object-fit: cover; border-radius: 2px; }
        .caption { font-family: 'Dancing Script', cursive; font-size: 1.6rem; text-align: center; margin-top: 15px; color: #444; }

        .counter { margin-top: 25px; color: var(--pink); font-weight: bold; background: white; padding: 6px 20px; border-radius: 20px; z-index: 10; }
        .hint { position: absolute; top: 10%; width: 100%; text-align: center; color: var(--pink); animation: pulse 2s infinite; font-weight: 600; }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* Bức thư cuối */
        #letter {
            display: none; position: fixed; inset: 0; background: var(--bg);
            z-index: 2000; justify-content: center; align-items: center;
        }
        .letter-content {
            background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 450px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); line-height: 1.8;
        }
        .letter-content h2 { font-family: 'Dancing Script'; color: var(--pink); margin: 0 0 15px 0; }

        /* Hiệu ứng tim */
        .heart { position: fixed; top: -10%; color: var(--pink); z-index: 1; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
    </style>
</head>
<body>

    <div id="intro">
        <h2 style="font-family: 'Dancing Script'; font-size: 2.8rem;">Gửi Nhím... ❤️</h2>
        <p>Tớ có một điều bất ngờ dành cho cậu</p>
        <button id="start-btn">Mở quà ngay</button>
    </div>

    <audio id="bg-music" loop>
        <source src="nhac.mp3" type="audio/mpeg">
    </audio>

    <div class="wrapper">
        <div id="main-app">
            <div class="gallery-content">
                <div class="hint">Chạm vào ảnh để xem kỷ niệm tiếp theo nhé...</div>
                <div id="photo-box" class="polaroid"></div>
                <div class="counter"><span id="cur">1</span> / 32</div>
            </div>
        </div>

        <div id="letter">
            <div class="letter-content">
                <h2>Gửi Nhím,</h2>
                <p>Chúc mừng sinh nhật cô gái tuyệt vời nhất của anh! Hy vọng món quà nhỏ này sẽ làm em vui. Anh yêu em rất nhiều! ❤️</p>
                <p style="text-align: right; font-family: 'Dancing Script'; font-size: 2rem; color: var(--pink); margin: 0;">Tiến</p>
            </div>
        </div>
    </div>

    <script>
        const photos = 32;
        let current = 1;
        const startBtn = document.getElementById('start-btn');
        const mainApp = document.getElementById('main-app');
        const letter = document.getElementById('letter');
        const photoBox = document.getElementById('photo-box');
        const music = document.getElementById('bg-music');

        startBtn.onclick = () => {
            document.getElementById('intro').style.opacity = '0';
            // PHÁT NHẠC MP3 KHI CLICK
            music.play().catch(e => console.log("Lỗi phát nhạc:", e));
            
            setTimeout(() => {
                document.getElementById('intro').style.display = 'none';
                mainApp.style.display = 'block';
                renderPhoto();
            }, 800);
        };

        function renderPhoto() {
            photoBox.style.opacity = '0';
            photoBox.style.transform = 'scale(0.8)';
            setTimeout(() => {
                photoBox.innerHTML = `
                    <img src="img/${current}.jpg" onerror="this.src='https://via.placeholder.com/300x400?text=Kỷ+niệm+${current}'">
                    <div class="caption">Memory #${current}</div>
                `;
                photoBox.style.opacity = '1';
                photoBox.style.transform = 'scale(1) rotate(' + (Math.random() * 6 - 3) + 'deg)';
                document.getElementById('cur').innerText = current;
            }, 200);
        }

        mainApp.onclick = () => {
            if (current < photos) {
                current++;
                renderPhoto();
            } else {
                mainApp.style.display = 'none';
                letter.style.display = 'flex';
            }
        };

        // Hiệu ứng tim bay
        setInterval(() => {
            const h = document.createElement('div');
            h.className = 'heart'; h.innerHTML = '❤️';
            h.style.left = Math.random() * 100 + 'vw';
            h.style.fontSize = (Math.random() * 10 + 15) + 'px';
            h.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 5000);
        }, 350);
    </script>
</body>
</html>